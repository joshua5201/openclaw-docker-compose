services:
  openclaw:
    build:
      context: .
      dockerfile: Dockerfile.sandbox
    image: openclaw:local
    container_name: openclaw
    restart: unless-stopped
    ports:
      - "127.0.0.1:18789:18789" # Gateway UI (Localhost only)
      - "18790:18790" # Bridge Port
    volumes:
      - ./openclaw:/app/openclaw
      # Use a named volume for node_modules to keep it isolated from host
      - openclaw_node_modules:/app/openclaw/node_modules
      - ./config:/home/node/.openclaw
      - ./workspace:/home/node/.openclaw/workspace
    environment:
      - OPENCLAW_CONFIG_DIR=/home/node/.openclaw
      - OPENCLAW_WORKSPACE_DIR=/home/node/.openclaw/workspace
      - NODE_ENV=production
    working_dir: /app/openclaw
    stdin_open: true
    tty: true
    # Command to start the gateway
    command: node dist/index.js gateway --bind lan --port 18789

  browserless:
    image: browserless/chrome:latest
    container_name: browserless
    restart: unless-stopped
    ports:
      - "3000:3000"
    shm_size: '2gb'
    environment:
      - CONCURRENT_SESSIONS=10

volumes:
  openclaw_node_modules: